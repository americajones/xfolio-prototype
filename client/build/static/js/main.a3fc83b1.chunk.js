(this["webpackJsonpproject-three"]=this["webpackJsonpproject-three"]||[]).push([[0],{34:function(e,t,a){e.exports=a(92)},92:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(29),o=a.n(r),c=a(1),s=a(6),u=a(11),i=a(33),m=a(2);const p=Object(n.createContext)(),d=p.Provider,g=(e,t)=>{switch(t.type){case"SET_CURRENT_USER":return Object(m.a)({},e,{type:t.type,_id:t._id,username:t.username,password:""});case"LOGIN_USER":case"ADD_USER":return Object(m.a)({},t);case"GALLERY_PROPS":return Object(m.a)({},e,{},t);default:return e}};let E={type:"",_id:"0",username:"",nickname:"",journal:[],works:[],favorites:[],password:"",uploaded:!1};const b=e=>{e.value;let t=Object(i.a)(e,["value"]);const a=Object(n.useReducer)(g,E),r=Object(c.a)(a,2),o=r[0],s=r[1];return l.a.createElement(d,Object.assign({value:[o,s]},t))},v=()=>Object(n.useContext)(p);var f=a(4),h=a.n(f),j=function(e){return h.a.get("/api/user/"+e)},O=function(e){return h.a.post("/api/user",{username:e.username,password:e.password,email:e.email})},y=function(e){return h.a.post("/api/user/login",{username:e.username,password:e.password})},w=function(){return h.a.get("/api/user")},R=e=>h.a.post("/api/artwork",e),S=e=>h.a.post("/api/blog",e),_=e=>h.a.get("/api/blog/"+e),C=a(14);const k={"default-state":{gradients:[["#29323c","#485563"],["#FF6B6B","#556270"],["#80d3fe","#7ea0c4"],["#f0ab51","#eceba3"]],transitionSpeed:7e3}},x={source:"../images/bg.jpeg",blendingMode:"multiply"};var L=()=>{const e=Object(n.useState)({username:"",password:""}),t=Object(c.a)(e,2),a=t[0],r=t[1],o=Object(n.useRef)(),u=Object(n.useRef)(),i=()=>{const e=o.current.value,t=u.current.value;r({username:e,password:t})};console.log("state",a);return l.a.createElement("div",{className:"login-page"},l.a.createElement("div",{className:"container login"},l.a.createElement("div",null,l.a.createElement("form",null,l.a.createElement("div",null,l.a.createElement("input",{type:"text",name:"username",placeholder:"Username",onChange:i,ref:o})),l.a.createElement("div",null,l.a.createElement("input",{type:"password",name:"password",placeholder:"password",onChange:i,ref:u})),l.a.createElement("div",null,l.a.createElement("button",{name:"login",onClick:e=>{e.preventDefault();const t={username:a.username,password:a.password};console.log("components/Login.js login",t),y(t).then(e=>{console.log("Login.js api.login() result",e.data.username),window.location.assign("/".concat(e.data.username,"/gallery"))}).catch(e=>console.log(e))}},"sign in")))),l.a.createElement(s.b,{to:"/Signup"},l.a.createElement("p",null,"New to Xfolio? Sign up here"))),l.a.createElement(C.a,{isPausedWhenNotInView:"true",image:x,states:k,id:"canvas-image"}))};const P={"default-state":{gradients:[["#e5ff00","#485563"],["#FF6B6B","#556270"],["#80d3fe","#7ea0c4"],["#f0ab51","#eceba3"]],transitionSpeed:7e3}},N={source:"../images/bg.jpeg",blendingMode:"multiply"};var D=()=>{const e=v(),t=Object(c.a)(e,2),a=t[0],r=t[1],o=Object(n.useState)({}),u=Object(c.a)(o,2),i=u[0],p=u[1];console.log("state",a);const d=Object(n.useRef)(),g=Object(n.useRef)(),E=Object(n.useRef)(),b=()=>{const e=d.current.value,t=g.current.value,a=E.current.value;p({username:t,password:a,email:e})};return l.a.createElement("div",{className:"signup-page"},l.a.createElement("div",{className:"container login signup"},l.a.createElement("div",null,l.a.createElement("form",null,l.a.createElement("div",null,l.a.createElement("p",null,"Sign up:"),l.a.createElement("input",{type:"text",name:"email",placeholder:"email",onChange:b,ref:d})),l.a.createElement("div",null,l.a.createElement("input",{type:"text",name:"username",placeholder:"Username",onChange:b,ref:g})),l.a.createElement("div",null,l.a.createElement("input",{type:"password",name:"password",placeholder:"password",onChange:b,ref:E})),l.a.createElement("div",null,l.a.createElement("button",{name:"signup",onClick:e=>{e.preventDefault();const t={email:i.email,username:i.username,password:i.password};console.log("components/Signup.js sign up",t),O(t).then(e=>{console.log("Signup.js api.signup() result",e.data),y({username:i.username,password:i.password}).then(e=>{console.log("user data after post to api/login from signup",e.data),r(Object(m.a)({},a,{type:"SET_CURRENT_USER",username:e.data.username,_id:e.data._id}))})}).catch(e=>{e&&console.log("components/Signup.js error",e)})}},"sign up"),l.a.createElement("br",null)))),l.a.createElement(s.b,{to:"/Login"},l.a.createElement("p",null,"Already have an account? Log in here"))),l.a.createElement(C.a,{isPausedWhenNotInView:"true",image:N,states:P,id:"canvas-image"}))};var I=()=>{const e=v(),t=Object(c.a)(e,2),a=t[0],r=t[1],o=Object(n.useState)({message:"",file:"",url:""}),s=Object(c.a)(o,2),u=s[0],i=s[1],p=Object(n.useState)({title:"",postBody:"",tags:[]}),d=Object(c.a)(p,2),g=d[0],E=d[1],b=Object(n.useRef)(),f=Object(n.useRef)(),j=Object(n.useRef)(),O=Object(n.useRef)(),y=Object(n.useRef)(),w=window.location.host,S=e=>{const t=g.title,n=g.postBody,l=g.tags,o=a._id;R({userId:o,url:e,title:t,postBody:n,tags:l}),r(Object(m.a)({},a,{uploaded:!0})),y.current.src="",f.current.value="",j.current.value="",O.current.value=""},_=e=>{e.preventDefault();const t=f.current.value,a=j.current.value,n=O.current.value.split(",").map(e=>e.trim().replace(/\s+/g,"_"));E(Object(m.a)({},g,{title:t,postBody:a,tags:n}))};return l.a.createElement("div",{className:"container upload"},l.a.createElement("form",{class:"upload-box"},l.a.createElement("div",{class:"upload-info"},l.a.createElement("div",null,l.a.createElement("label",{htmlFor:"upload"},"Choose an image"),l.a.createElement("input",{id:"upload-file",type:"file",name:"upload",accept:"image/*",onChange:e=>{e.preventDefault();const t=b.current.files;if(t&&t.length>0){const e=t[0];i(Object(m.a)({},u,{file:e}));const a=new FileReader,n=y.current;n.file=e,a.onload=e=>{n.src=e.target.result},a.readAsDataURL(e)}},ref:b})),l.a.createElement("div",{class:"upload-mess"},u.message),l.a.createElement("div",null,l.a.createElement("p",null," Title: "),l.a.createElement("input",{type:"text",name:"title",ref:f,onChange:_})),l.a.createElement("div",null,l.a.createElement("p",null,"Description:"),l.a.createElement("textarea",{name:"body",ref:j,onChange:_})),l.a.createElement("div",null,l.a.createElement("p",null,"Tags, separated by a comma:"),l.a.createElement("input",{type:"text",name:"tags",ref:O,onChange:_})),l.a.createElement("div",null,l.a.createElement("button",{onClick:e=>{e.preventDefault();const t=u.file;i(Object(m.a)({},u,{message:"Uploading..."}));const n=t.type,l="https://".concat(w,"/generate-put-url"),r={params:{Key:"".concat(a.username,"/works/").concat(Date.now(),"_").concat(t.name),ContentType:n},headers:{"Content-Type":n}};h.a.get(l,r).then(e=>{const a=e.data;h.a.put(a,t,r).then(e=>{i(Object(m.a)({},u,{message:"Upload Successful"}));const t=e.config.params,a="https://".concat(w,"/generate-put-url"),n={params:t};h.a.get(a,n).then(e=>{const t=e.data.replace(/\?.*/,"");i(Object(m.a)({},u,{url:t})),S(t)})}).catch(e=>{i(Object(m.a)({},u,{message:"Something went wrong, try again"})),console.log("err",e)})})}},"Submit"))),l.a.createElement("div",{class:"upload-prev"},l.a.createElement("img",{ref:y,alt:"preview",width:"140px"}))))};var U=()=>{const e=v(),t=Object(c.a)(e,1)[0].journal;return t.length?l.a.createElement("div",null,t.map(e=>l.a.createElement("div",{key:e.title},l.a.createElement("h2",null,e.title),l.a.createElement("div",null,e.body),l.a.createElement("div",null,e.tags)))):l.a.createElement("div",null,l.a.createElement("h3",null,"You don't have any posts yet"),l.a.createElement(s.b,{to:"gallery"},"Gallery Page"))};var B=()=>{const e=v(),t=Object(c.a)(e,2),a=t[0],r=t[1],o=Object(n.useState)(),s=Object(c.a)(o,2),u=s[0],i=s[1],p=Object(n.useRef)(),d=Object(n.useRef)(),g=Object(n.useRef)();return console.log("postState",u),l.a.createElement("div",null,l.a.createElement("form",{onChange:e=>{e.preventDefault();const t=p.current.value,a=d.current.value,n=g.current.value.split(",").map(e=>e.trim().replace(/\s+/g,"_"));console.log({title:t,body:a,tags:[n]}),i({title:t,body:a,tags:n})}},l.a.createElement("div",null,l.a.createElement("input",{type:"text",name:"title",placeholder:"Post Title",ref:p})),l.a.createElement("div",null,l.a.createElement("textarea",{name:"body",placeholder:"What's up buttercup?",ref:d})),l.a.createElement("div",null,l.a.createElement("input",{type:"text",name:"tags",placeholder:"separate tags with commas, like, this",ref:g})),l.a.createElement("div",null,l.a.createElement("button",{name:"submit",onClick:e=>{e.preventDefault();const t=u.title,n=u.body,l=u.tags,o=a._id;S({userId:o,title:t,body:n,tags:l}),r(Object(m.a)({},a,{type:"GALLERY_PROPS",uploaded:!0}))}},"Submit Post"))))};var T=e=>{const t=v(),a=Object(c.a)(t,2),r=a[0],o=a[1];console.log("props in blog",e);const s=window.location.toString().split("/");return console.log("url",s[3]),Object(n.useEffect)(()=>{_(s[3]).then(e=>{console.log("no props res",e.data),o(Object(m.a)({},r,{_id:e.data._id,type:"GALLERY_PROPS",journal:e.data.journal,uploaded:!1}))}).catch(e=>console.log("err",e))},[r.uploaded]),console.log("state",r),l.a.createElement("div",{className:"container blog"},l.a.createElement("div",null,l.a.createElement("h1",null,"Hello ",e.username,"!")),l.a.createElement(B,null),l.a.createElement(U,null))};var A=e=>{const t=v(),a=Object(c.a)(t,2),r=a[0],o=a[1],u=Object(n.useState)({works:[]}),i=Object(c.a)(u,2),p=i[0],d=i[1];console.log("props in gallery",e),console.log("state",r),Object(n.useEffect)(()=>{console.log("props",e._id),j(e.username).then(e=>{console.log("gallery get res",e.data),d({works:e.data.works}),o(Object(m.a)({},r,{type:"GALLERY_PROPS",username:e.data.username,_id:e.data._id}))})},[e,r.uploaded]);const g=p.works;return console.log("works",g),g&&g.length?l.a.createElement("div",{class:"gallery-box"},l.a.createElement("div",{class:"profile"},l.a.createElement("p",null,"Welcome to Xfolio:"),l.a.createElement(I,null),l.a.createElement("br",null),l.a.createElement(s.b,{to:"blog"},"Go to your Jounral")),l.a.createElement("div",{class:"gallery"},g.map(e=>l.a.createElement("div",{class:"gall",key:e._id},l.a.createElement("div",{class:"gall-thumb"},l.a.createElement("img",{src:e.img,alt:e.title})),l.a.createElement("div",{class:"gall-info"},l.a.createElement("div",null,l.a.createElement("i",null,e.title)),l.a.createElement("div",{class:"gall-descrip"},e.description),l.a.createElement("div",{class:"gall-tags"},e.tags)))))):l.a.createElement("div",null,l.a.createElement(I,null),l.a.createElement("h3",null,"No posts yet!"),l.a.createElement(s.b,{to:"blog"},"Go to your blog page"))};var G=()=>{const e=Object(n.useState)({loggedIn:!1,username:"",_id:""}),t=Object(c.a)(e,2),a=t[0],r=t[1];console.log("isLoggedIn state",a),Object(n.useEffect)(()=>{w().then(e=>{console.log("res in App.js useEffect",e.data),r({loggedIn:!0,username:e.data.user[0].username,_id:e.data.user[0]._id})}).catch(e=>{console.log("error",e)})},[]);const o=a.loggedIn,i=a.username,m=a._id;return l.a.createElement(b,null,l.a.createElement(s.a,null,l.a.createElement(u.c,null,l.a.createElement(u.a,{exact:!0,path:"/",component:L}),l.a.createElement(u.a,{exact:!0,path:"/Login",component:L}),l.a.createElement(u.a,{exact:!0,path:"/Signup",component:D}),l.a.createElement(u.a,{exact:!0,path:"/:username/blog"},l.a.createElement(T,{loggedIn:o,username:i,_id:m})),l.a.createElement(u.a,{exact:!0,path:"/:username/gallery"},l.a.createElement(A,{loggedIn:o,username:i,_id:m})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(l.a.createElement(G,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()}).catch(e=>{console.error(e.message)})}},[[34,1,2]]]);
//# sourceMappingURL=main.a3fc83b1.chunk.js.map